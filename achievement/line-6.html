<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors" />
    <meta name="generator" content="Hugo 0.104.2" />
    <title>My Padamelan</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/dashboard/" />

    <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- my Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Agbalumo&display=swap" rel="stylesheet" />

    <!-- Box Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" />

    <!-- Sweetalert2 -->
    <link rel="stylesheet" href="../assets/dist/sweetalert2/sweetalert2.min.css" />
    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        height: 3rem;
        background-color: rgba(0, 0, 0, 0.1);
        border: solid rgba(0, 0, 0, 0.15);
        border-width: 1px 0;
        box-shadow:
          inset 0 0.5em 1.5em rgba(0, 0, 0, 0.1),
          inset 0 0.125em 0.5em rgba(0, 0, 0, 0.15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -0.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }
    </style>

    <!-- Custom styles for this template -->
    <link href="../css/dashboard.css" rel="stylesheet" />
  </head>
  <body>
    <header class="navbar navbar-dark sticky-top bg-danger flex-md-nowrap p-0 shadow">
      <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6" href="#" style="font-family: &quot;Agbalumo&quot;; text-transform: uppercase">MY padamelan</a>
      <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </header>

    <div class="container-fluid">
      <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
          <div class="position-sticky mb-2 sidebar-sticky">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link" href="../index.html">
                  <i class="bx bx-package"></i>
                  Opname Material
                </a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="../reject.html">
                  <i class="bx bxs-coffee-togo"></i>
                  Data Reject
                </a>
              </li>
            </ul>

            <h6 class="sidebar-heading align-items-center px-3 mt-3 mb-1 text-body-secondary text-uppercase">Line 6</h6>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link" href="../achievement/line-6.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Achievement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../blowing/line6.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Blowing
                </a>
              </li>
            </ul>
            <h6 class="sidebar-heading align-items-center px-3 mt-3 mb-1 text-body-secondary text-uppercase">Line 7</h6>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link" href="../achievement/line-7.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Achievement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../blowing/line7.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Blowing
                </a>
              </li>
            </ul>
            <h6 class="sidebar-heading align-items-center px-3 mt-3 mb-1 text-body-secondary text-uppercase">Line 8</h6>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link" href="../achievement/line-8.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Achievement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../blowing/line8.html">
                  <i class="bx bx-radio-circle-marked"></i>
                  Update Blowing
                </a>
              </li>
            </ul>
          </div>
        </nav>
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h4 mb-2">Update Achievement</h1>
          </div>

          <!-- Modal -->
          <form id="formTransaksi">
            <div class="card">
              <div class="card-body">
                <div class="row text-center">
                  <div class="col-md-12">
                    <div class="result"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-3">
              <div class="card-header fw-bold">Identitas Produksi</div>
              <div class="card-body">
                <div class="row g-2">
                  <div class="col-6">
                    <select class="form-select" id="input-shift">
                      <option selected>Shift</option>
                      <option value="1">Shift 1</option>
                      <option value="2">Shift 2</option>
                      <option value="3">Shift 3</option>
                    </select>
                  </div>

                  <div class="col-6">
                    <select class="form-select" id="input-produk" name="produk">
                      <option selected>Jenis Produk</option>
                      <option value="3L">3 Liter</option>
                      <option value="5L">5 Liter</option>
                    </select>
                  </div>

                  <div class="col-6">
                    <input type="date" class="form-control" id="input_tgl" name="input_tgl" />
                  </div>

                  <div class="col-6">
                    <select class="form-select" id="input-sku" name="sku">
                      <option selected>Pilih SKU</option>
                      <option value="Reguler">Reguler</option>
                      <option value="Phill_Reguler">Phill Reguler</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-3">
              <div class="card-header fw-bold">Jam & Pallet</div>
              <div class="card-body">
                <div class="row g-2">
                  <div class="col-6">
                    <div class="form-floating">
                      <input type="time" class="form-control" id="jam_awal" name="jam_awal" />
                      <label>Dari Jam</label>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="form-floating">
                      <input type="time" class="form-control" id="jam_akhir" name="jam_akhir" />
                      <label>Sampai Jam</label>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="form-floating">
                      <input type="number" class="form-control" id="awal" name="awal" />
                      <label>No Pallet Awal</label>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="form-floating">
                      <input type="number" class="form-control" id="akhir" name="akhir" />
                      <label>No Pallet Akhir</label>
                    </div>
                  </div>

                  <div class="col-12">
                    <div class="form-floating">
                      <input type="number" class="form-control" id="weigher" name="weigher" />
                      <label>Reject Weigher</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-5">
              <div class="card-body">
                <button class="btn btn-outline-dark w-100 mb-2" data-bs-toggle="collapse" data-bs-target="#notedCollapse">üìù Noted / Penyesuaian</button>

                <div class="collapse" id="notedCollapse">
                  <div class="row g-2 mt-2">
                    <div class="col-6">
                      <div class="form-floating">
                        <input type="number" class="form-control" id="receh" name="receh" />
                        <label>Receh</label>
                      </div>
                    </div>

                    <div class="col-6">
                      <div class="form-floating">
                        <input type="number" class="form-control" id="buffer" name="buffer" />
                        <label>Buffer</label>
                      </div>
                    </div>

                    <div class="col-6">
                      <div class="form-floating">
                        <input type="number" class="form-control" id="minus" name="minus" />
                        <label>Minus</label>
                      </div>
                    </div>

                    <div class="col-12">
                      <div class="form-floating">
                        <input type="text" class="form-control" id="note" name="note" />
                        <label>Catatan</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="sticky-bottom bg-light border-top">
              <div class="d-flex justify-content-end gap-2 p-2">
                <button type="button" id="btnWhatsapp" class="btn btn-success btn-sm rounded-pill px-2"><i class="bx bxl-whatsapp"></i> Share</button>

                <button type="button" id="reset" class="btn btn-danger btn-sm rounded-pill px-2">Reset</button>
                <button type="button" id="btnEditMode" class="btn btn-warning btn-sm rounded-pill px-2">Edit Data</button>

                <button type="submit" id="submit" class="btn btn-primary btn-sm rounded-pill px-4">Submit</button>
                <button id="btnUpdateData" style="display: none" type="button" class="btn btn-outline-warning btn-sm rounded-pill px-4">Update Data</button>
              </div>
            </div>
          </form>
        </main>
      </div>
    </div>

    <script src="../assets/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js" integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha" crossorigin="anonymous"></script>
    <script src="../js/jquery.js"></script>
    <script src="../js/dashboard.js"></script>
    <!-- Sweetalert2 -->
    <script src="../assets/dist/sweetalert2/sweetalert2.min.js"></script>
    <!-- <script>
      // Mengatur nilai input tanggal menjadi tanggal hari ini
      $(document).ready(function () {
        document.getElementById("input_tgl").valueAsDate = new Date();

        // Mendapatkan nilai dari input tanggal
        var inputTanggal = document.getElementById("input_tgl").valueAsDate;

        // Mengatur nilai h4 dengan format "Hari, Tanggal Bulan Tahun"
        var options = { weekday: "long", year: "numeric", month: "long", day: "numeric" };
        var formattedDate = inputTanggal.toLocaleDateString("id-ID", options);
        document.getElementById("tgl_produksi").textContent = formattedDate;
      });
    </script> -->

    <script>
      /*************************************************
       * KONSTANTA LOCALSTORAGE
       *************************************************/
      const HEADER_KEY = "headerLine6";
      const DATA_KEY = "line6";
      const LAST_INPUT_KEY = "lastInputLine6";
      let editMode = false;
      let editIndex = null;

      /*************************************************
       * HEADER
       *************************************************/
      function saveHeader() {
        const header = {
          shift: $("#input-shift").val(),
          tanggal: $("#input_tgl").val(),
          produk: $("#input-produk").val(),
          sku: $("#input-sku").val(),
        };
        localStorage.setItem(HEADER_KEY, JSON.stringify(header));
      }

      function loadHeader() {
        const header = JSON.parse(localStorage.getItem(HEADER_KEY));
        if (!header) {
          $("#input_tgl").val(new Date().toISOString().split("T")[0]);
          return;
        }

        $("#input-shift").val(header.shift);
        $("#input_tgl").val(header.tanggal);
        $("#input-produk").val(header.produk);
        $("#input-sku").val(header.sku);
      }

      function formatTanggal(tgl) {
        return new Date(tgl).toLocaleDateString("id-ID", {
          weekday: "long",
          day: "numeric",
          month: "long",
          year: "numeric",
        });
      }

      /*************************************************
       * LOAD INPUT TERAKHIR
       *************************************************/
      function loadLastInput() {
        const last = JSON.parse(localStorage.getItem(LAST_INPUT_KEY));
        if (!last) {
          $("#weigher").val(0);
          return;
        }

        $("#jam_awal").val(last.jam_awal);
        $("#jam_akhir").val(last.jam_akhir);
        $("#awal").val(last.akhirTerakhir);
        $("#akhir").val("");
        $("#weigher").val(0);
      }

      /*************************************************
       * Edit Data
       *************************************************/
      function pilihDataEdit(index) {
        const data = JSON.parse(localStorage.getItem("line6")) || [];
        const item = data[index];

        editIndex = index;

        $("#jam_awal").val(item.jam_awal);
        $("#jam_akhir").val(item.jam_akhir);
        $("#awal").val(item.awal);
        $("#akhir").val(item.akhir);
        $("#weigher").val(item.weigher || 0);
        $("#receh").val(item.receh || 0);
        $("#buffer").val(item.buffer || 0);
        $("#minus").val(item.minus || 0);
        $("#note").val(item.note || "");

        $("#btnUpdateData").show();
        $("#submit").hide();
        $("#btnEditMode").hide();

        editMode = false;

        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // ============================
      // Button Edit
      // ============================
      $("#btnEditMode").on("click", function () {
        editMode = !editMode;

        $(this).toggleClass("btn-outline-warning btn-warning");

        $(this).text(editMode ? "Pilih Data" : "Edit Data");

        $(".result").html(showData(JSON.parse(localStorage.getItem("line6")) || []));
      });

      $("#btnUpdateData").on("click", function (e) {
        e.preventDefault();

        let data = JSON.parse(localStorage.getItem(DATA_KEY)) || [];
        if (editIndex === null) return;

        const updatedData = ambilDataForm();
        const dataawal = loadLastInput();
        const isLastData = editIndex === data.length - 1;
        data[editIndex] = updatedData;

        localStorage.setItem(DATA_KEY, JSON.stringify(data));

        if (isLastData) {
          // kalau edit data TERAKHIR
          $("#jam_awal").val(updatedData.jam_akhir);
          $("#jam_akhir").val(tambahSatuJam(updatedData.jam_akhir));
          $("#awal").val(updatedData.akhir);
          $("#akhir").val("");
        } else {
          // kalau edit data LAMA ‚Üí restore lastInput
          loadLastInput();
        }

        editIndex = null;
        editMode = false;

        $("#btnUpdateData").hide();
        $("#submit").show();
        $("#btnEditMode").show();

        $(".result").html(showData(data));

        Swal.fire({
          icon: "success",
          title: "Data diperbarui",
          timer: 1200,
          showConfirmButton: false,
        });
      });

      function ambilDataForm() {
        const form = $("#formTransaksi").serializeArray();
        let obj = {};

        form.forEach((item) => {
          const numericFields = ["awal", "akhir", "receh", "weigher", "buffer", "minus"];
          obj[item.name] = numericFields.includes(item.name) ? Number(item.value) || 0 : item.value;
        });

        return obj;
      }

      /*************************************************
       * Reset Data
       *************************************************/
      $("#reset").on("click", function () {
        Swal.fire({
          title: "Yakin ingin menghapus data?",
          text: "Semua data produksi LINE 6 akan dihapus dan tidak bisa dikembalikan!",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#d33",
          cancelButtonColor: "#3085d6",
          confirmButtonText: "Ya, hapus data!",
          cancelButtonText: "Batal",
        }).then((result) => {
          if (result.isConfirmed) {
            // HAPUS DATA PRODUKSI SAJA
            localStorage.removeItem("line6");
            localStorage.removeItem("lastInputLine6");

            // RESET FORM INPUT
            $("#awal").val("");
            $("#akhir").val("");
            $("#receh").val("");
            $("#weigher").val(0);

            // RESET VAR GLOBAL
            editIndex = null;
            line6 = [];

            // UPDATE TAMPILAN
            $(".result").html(`<h5>Silahkan Isi Form Di bawah Ini</h5>`);

            Swal.fire({
              icon: "success",
              title: "Berhasil",
              text: "Data produksi berhasil dihapus.",
              timer: 1500,
              showConfirmButton: false,
            });
          }
        });
      });

      /*************************************************
       * INSERT DATA (LOGIKA ASLI + SIMPAN INPUT TERAKHIR)
       *************************************************/
      function insert() {
        const form = $("#formTransaksi").serializeArray();
        let line6 = JSON.parse(localStorage.getItem(DATA_KEY)) || [];

        let newData = {};

        form.forEach((item) => {
          const numericFields = ["awal", "akhir", "receh", "weigher", "buffer", "minus"];
          newData[item.name] = numericFields.includes(item.name) ? Number(item.value) || 0 : item.value;
        });

        line6.push(newData);
        localStorage.setItem(DATA_KEY, JSON.stringify(line6));

        localStorage.setItem(
          LAST_INPUT_KEY,
          JSON.stringify({
            jam_awal: newData.jam_awal,
            jam_akhir: newData.jam_akhir,
            akhirTerakhir: newData.akhir,
          }),
        );

        return line6;
      }

      function tambahSatuJam(jam) {
        if (!jam) return "";

        let [hh, mm] = jam.split(":").map(Number);
        hh = (hh + 1) % 24; // aman lewat jam 24

        return String(hh).padStart(2, "0") + ":" + String(mm).padStart(2, "0");
      }

      /*************************************************
       * SHOW DATA
       *************************************************/
      function showData(line6) {
        if (!line6.length) return `<h5>Silahkan Isi Form Di bawah Ini</h5>`;

        const header = JSON.parse(localStorage.getItem(HEADER_KEY)) || {};
        const shift = header.shift || "Shift 2";
        const tanggal = header.tanggal ? formatTanggal(header.tanggal) : "";
        const produk = header.produk || "3L";
        const sku = header.sku === "Phill_Reguler" ? "Phill Reguler" : "Reguler";

        let produksiHtml = "";
        let rejectHtml = "";
        let total = 0;
        // let editIndex = null;
        const note = $("#note").val();
        const buffer = Number($("#buffer").val()) || 0;
        const minus = Number($("#minus").val()) || 0;

        line6.forEach((item, index) => {
          let hasil = item.akhir - item.awal;
          let jumlahCar = produk === "3L" ? hasil * 30 + (item.receh || 0) : hasil * 27 + (item.receh || 0);

          let persen = Math.round((jumlahCar / (produk === "3L" ? 1000 : 1500)) * 100);

          let grade = persen >= 90 ? "(A)" : persen >= 85 ? "(B)" : persen >= 82.5 ? "(C)" : persen >= 80 ? "(D)" : "(E)";

          total += jumlahCar;

          rejectHtml += `${item.jam_awal.replace(":", ".")}-${item.jam_akhir.replace(":", ".")} = ${item.weigher}\n`;

          if (editMode) {
            produksiHtml += `
            <a href="#"
              class="list-group-item list-group-item-action d-flex justify-content-between px-0"
              onclick="pilihDataEdit(${index})">
              <span>
                ${item.jam_awal.replace(":", ".")}-${item.jam_akhir.replace(":", ".")}
                = <b>${jumlahCar.toLocaleString("id-ID")}</b> car
              </span>
              <span class="badge bg-warning text-dark">EDIT</span>
            </a>
          `;
          } else {
            produksiHtml += `
            <div class="list-group-item d-flex justify-content-between px-0">
              <span>
                ${item.jam_awal.replace(":", ".")}-${item.jam_akhir.replace(":", ".")}
                = <b>${jumlahCar.toLocaleString("id-ID")}</b> car
              </span>
              <span class="text-muted">${persen}% ${grade}</span>
            </div>
          `;
          }
        });

        let totalAkhir = total + buffer - minus;

        let noteHtml = "";
        if (minus) noteHtml = `<b>*${note} = ${minus} car*</b>`;
        else if (buffer) noteHtml = `<b>*${note} = ${buffer} car*</b>`;
        else if (note) noteHtml = `<b>${note}</b>`;

        return `
<div class="card shadow-sm mb-3">
  <div class="card-body text-center">
    <h5 class="mb-1">Hasil Produksi Shift ${shift}</h5>
    <div class="fw-semibold">LINE 6</div>
    <div class="text-muted mb-2">${tanggal}</div>

    <div class="badge bg-success mb-3">
      Le Minerale ${produk} ${sku} ‚Äî ${totalAkhir.toLocaleString("id-ID")} car
    </div>

    <hr>

    <div class="text-start">
      <div class="fw-bold mb-1">Detail Produksi</div>
     <div class="list-group list-group-flush small">
        ${produksiHtml}
      </div>

    </div>

    <div class="text-start mt-2">
      <div class="fw-bold mb-1">Reject Weigher</div>
      <pre class="fs-6">${rejectHtml}</pre>
    </div>

    ${noteHtml}

  </div>
</div>
`;
      }

      /*************************************************
       * Kirim Data Ke Whatapp
       *************************************************/
      function buildWhatsappText() {
        const header = JSON.parse(localStorage.getItem("headerLine6")) || {};
        const line6 = JSON.parse(localStorage.getItem("line6")) || [];

        if (line6.length === 0) {
          Swal.fire("Data kosong", "Tidak ada data untuk dikirim", "warning");
          return "";
        }

        const shift = header.shift || "Shift 1";
        const tanggal = header.tanggal ? formatTanggal(header.tanggal) : "";
        const produk = header.produk || "5L";
        const sku = header.sku === "Phill_Reguler" ? "Phill Reguler" : "Reguler";

        let produksiText = "";
        let rejectText = "";
        let total = 0;

        line6.forEach((item) => {
          let hasil = item.akhir - item.awal;
          let jumlahCar = produk === "3L" ? hasil * 30 + (item.receh || 0) : hasil * 27 + (item.receh || 0);

          let persen = Math.round((jumlahCar / (produk === "3L" ? 1000 : 1500)) * 100);

          let grade = persen >= 90 ? "(A)" : persen >= 85 ? "(B)" : persen >= 82.5 ? "(C)" : persen >= 80 ? "(D)" : "(E)";

          total += jumlahCar;

          let jamAwal = item.jam_awal.replace(":", ".");
          let jamAkhir = item.jam_akhir.replace(":", ".");

          produksiText += `${jamAwal}-${jamAkhir} = ${jumlahCar.toLocaleString("id-ID")} car ${persen}% ${grade}\n`;

          rejectText += `${jamAwal}-${jamAkhir} = ${item.weigher || 0}\n`;
        });

        let message = `*Hasil Produksi Shift ${shift}*
_*LINE 6*_
*${tanggal}*\n
_Le Minerale ${produk} ${sku}_ *${total.toLocaleString("id-ID")} car*

${produksiText}
*Update Reject Weigher*
${rejectText}`;

        return message.trim();
      }

      /*************************************************
       * INIT
       *************************************************/
      $(document).ready(function () {
        loadHeader();
        loadLastInput();

        let line6 = JSON.parse(localStorage.getItem(DATA_KEY)) || [];
        $(".result").html(showData(line6));

        // ============================
        // LOAD JAM SAAT REFRESH
        // ============================
        const lastJam = JSON.parse(localStorage.getItem("lastJamLine6"));

        if (lastJam && lastJam.jam_akhir) {
          $("#jam_awal").val(lastJam.jam_akhir);
          $("#jam_akhir").val(tambahSatuJam(lastJam.jam_akhir));
        }

        // ============================
        // HEADER CHANGE
        // ============================
        $("#input-shift, #input_tgl, #input-produk, #input-sku").on("change", function () {
          saveHeader();
          $(".result").html(showData(line6));
        });

        // ============================
        // SUBMIT DATA
        // ============================
        $("#formTransaksi").on("submit", function (e) {
          e.preventDefault();

          insert();

          // simpan JAM AKHIR TERAKHIR
          localStorage.setItem(
            "lastJamLine6",
            JSON.stringify({
              jam_akhir: $("#jam_akhir").val(),
            }),
          );

          line6 = JSON.parse(localStorage.getItem(DATA_KEY)) || [];
          $(".result").html(showData(line6));

          // ============================
          // AUTO +1 JAM
          // ============================
          const nextJamAwal = tambahSatuJam($("#jam_awal").val());
          const nextJamAkhir = tambahSatuJam($("#jam_akhir").val());

          $("#jam_awal").val(nextJamAwal);
          $("#jam_akhir").val(nextJamAkhir);

          // ============================
          // RESET FIELD LAIN
          // ============================
          $("#awal").val($("#akhir").val());
          $("#akhir").val("");
          $("#receh").val("");
          $("#weigher").val(0);
        });

        // ============================
        // WHATSAPP
        // ============================
        $("#btnWhatsapp").on("click", function () {
          const text = buildWhatsappText();
          if (!text) return;

          const url = "https://wa.me/?text=" + encodeURIComponent(text);
          window.open(url, "_blank");
        });
      });
    </script>
  </body>
</html>
